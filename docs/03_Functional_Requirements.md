# 3. Функциональные требования

## 3.1. Аутентификация и Авторизация
*   **FR1.1:** Система должна позволять пользователям регистрировать новые учетные записи, предоставляя уникальное имя пользователя и пароль.
*   **FR1.2:** Система должна позволять зарегистрированным пользователям входить в систему, используя их учетные данные.
*   **FR1.3:** Система должна обеспечивать защиту аутентифицированных маршрутов и операций, доступных только вошедшим в систему пользователям (например, создание игры, игровой процесс).
*   **FR1.4:** Система должна позволять пользователям выходить из системы.

## 3.2. Управление играми и Лобби
*   **FR2.1:** Авторизованный пользователь должен иметь возможность создать новую игру. Созданная игра отображается в списке доступных игр (лобби) и ожидает присоединения второго игрока.
*   **FR2.2:** Авторизованный пользователь должен иметь возможность видеть список игр, созданных другими пользователями и ожидающих второго игрока.
*   **FR2.3:** Авторизованный пользователь должен иметь возможность присоединиться к существующей игре из списка ожидающих.
*   **FR2.4:** Система должна автоматически связывать двух игроков (создателя и присоединившегося) для начала игры.
*   **FR2.5:** После завершения игры или выхода из нее, пользователь должен возвращаться в лобби.

## 3.3. Расстановка кораблей
*   **FR3.1:** После того как два игрока объединены в игру, каждый из них должен перейти к этапу ручной расстановки своего флота на индивидуальном игровом поле размером 10x10 ячеек.
*   **FR3.2:** Стандартный флот включает: 1 корабль на 4 ячейки, 2 корабля на 3 ячейки, 3 корабля на 2 ячейки, 4 корабля на 1 ячейку.
*   **FR3.3:** Система должна предоставлять интерактивный интерфейс для:
    *   Выбора типа корабля из доступного набора для размещения.
    *   Выбора ориентации корабля (горизонтальная/вертикальная).
    *   Размещения выбранного корабля на свободной ячейке поля путем клика.
*   **FR3.4:** Система должна выполнять валидацию расстановки кораблей на стороне клиента и сервера:
    *   Корабли не должны выходить за пределы игрового поля.
    *   Корабли не должны пересекаться или накладываться друг на друга.
    *   Корабли не должны касаться друг друга сторонами или углами (должны быть окружены пустыми ячейками).
*   **FR3.5:** Игрок должен иметь возможность сбросить текущую расстановку всех кораблей и начать заново.
*   **FR3.6:** Игрок должен подтвердить свою расстановку. После подтверждения расстановка становится невидимой для противника. Флаг `BoardSet` для игрока устанавливается в `true`.

## 3.4. Игровой процесс
*   **FR4.1:** После того как оба игрока подтвердили расстановку своих кораблей (оба флага `BoardSet` = `true`), система должна предложить игрокам подтвердить готовность к началу боя (кнопка "Готов").
*   **FR4.2:** Игра начинается (переходит в состояние "Игра идет") только после того, как оба игрока подтвердили свою готовность (оба флага `PlayerReady` = `true`).
*   **FR4.3:** Система должна определять очередность первого хода (например, создатель игры ходит первым или случайно).
*   **FR4.4:** Игроки ходят поочередно, делая выстрел по одной ячейке на поле противника.
*   **FR4.5:** Система должна четко отображать игрокам:
    *   Их собственное поле с их кораблями (если не скрыты после расстановки), отметками выстрелов противника (попадание, промах).
    *   Поле противника с отметками их собственных выстрелов (попадание, промах, потоплен).
*   **FR4.6:** Система должна фиксировать и отображать результат выстрела:
    *   **Промах:** Выстрел пришелся в пустую ячейку.
    *   **Попадание:** Выстрел пришелся в ячейку, занятую кораблем противника, но корабль еще не потоплен.
    *   **Потопил:** Выстрел пришелся в последнюю неуничтоженную ячейку корабля противника.
*   **FR4.7:** После промаха ход автоматически передается противнику.
*   **FR4.8:** После попадания или потопления корабля игрок, совершивший выстрел, получает право на следующий ход.
*   **FR4.9:** Игра продолжается до тех пор, пока один из игроков не уничтожит все корабли противника.
*   **FR4.10:** Система должна однозначно определить победителя и уведомить об этом обоих игроков, отображая соответствующее сообщение.
*   **FR4.11:** Система должна обеспечивать обновление состояния игры (ходы, результаты выстрелов, состояние досок, смена хода, завершение игры) в реальном времени для обоих игроков с использованием SignalR.
*   **FR4.12:** Пользователь должен иметь возможность покинуть текущую игру. Если игра активна, это засчитывается как поражение.

## 3.5. История игр и Таблица лидеров (Рейтинг)
*   **FR5.1:** Система должна сохранять историю завершенных игр для каждого участвовавшего игрока. Запись истории должна включать как минимум: имена обоих игроков, победителя, дату игры.
*   **FR5.2:** Авторизованный пользователь должен иметь возможность просматривать свою личную историю игр на странице лобби.
*   **FR5.3:** Система должна вести рейтинг игроков на основе их результатов в играх. Начальный рейтинг - 1000. За победу +15 очков, за поражение -10 очков. Рейтинг не может быть ниже 0.
*   **FR5.4:** Система должна отображать таблицу лидеров (например, топ N игроков) в лобби, показывающую имя игрока, его рейтинг, количество побед, поражений и общее количество игр.
*   **FR5.5:** Рейтинг и статистика игрока (победы, поражения, общее количество игр) должны автоматически обновляться после каждой завершенной игры.

## 3.6. Пользовательский интерфейс (Общие)
*   **FR6.1:** Интерфейс должен быть интуитивно понятным, современным, визуально привлекательным и отзывчивым (адаптироваться под разные размеры экрана, если применимо).
*   **FR6.2:** Система должна предоставлять своевременную и понятную обратную связь пользователю о его действиях, статусе игры, ошибках и другой важной информации.
*   **FR6.3:** Навигация по приложению должна быть простой и логичной. 